<link rel="stylesheet" href="../assets/css/views/usuarios.css">
<div class="login-container">
  <form id="login-form">
    <h2>Iniciar Sesión</h2>

    <label for="email">Correo electrónico:</label>
    <input type="email" id="email" name="email" required />

    <label for="password">Contraseña:</label>
    <input type="password" id="password" name="password" required />

    <button type="submit">Ingresar</button>

    <p id="login-error" class="error-message"></p>
  </form>
</div>

<script type="module">
  import { login } from '../../assets/js/api/usuarios.js';

  const form = document.getElementById('login-form');
  const errorDisplay = document.getElementById('login-error');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = form.email.value.trim();
    const password = form.password.value.trim();

    try {
      const response = await login(email, password);
      if (response.token) {
        localStorage.setItem('token', response.token);
        window.location.hash = '#/dashboard';
      } else {
        errorDisplay.textContent = response.message || 'Credenciales inválidas';
      }
    } catch (error) {
      errorDisplay.textContent = 'Error al intentar iniciar sesión.';
      console.error(error);
    }
  });
</script>
